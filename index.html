<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>üìñ B√≠blia Digital</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="manifest" href="data:application/manifest+json,{&quot;name&quot;:&quot;B√≠blia Digital&quot;,&quot;short_name&quot;:&quot;B√≠blia&quot;,&quot;start_url&quot;:&quot;.&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;background_color&quot;:&quot;#ffffff&quot;,&quot;theme_color&quot;:&quot;#1e3a8a&quot;}">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

    :root {
      --bg: #f0f4f8;
      --bg2: #d9e9f7;
      --text: #222;
      --card: #fff;
      --primary: #2563eb;
      --shadow: rgba(0,0,0,0.05);
    }

    body.dark {
      --bg: #0f172a;
      --bg2: #1e293b;
      --text: #f8fafc;
      --card: #1e293b;
      --primary: #38bdf8;
      --shadow: rgba(0,0,0,0.4);
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, var(--bg), var(--bg2));
      margin: 0;
      padding: 20px;
      color: var(--text);
      transition: .3s;
    }

    header { 
      text-align: center; 
      margin-bottom: 20px; 
      position: relative;
    }
    h1 { font-weight: 600; color: var(--primary); margin-bottom: 10px; }

    .top-buttons {
      position: absolute;
      top: 0;
      right: 0;
      display: flex;
      gap: 10px;
    }
    .icon-btn {
      background: none;
      border: none;
      font-size: 22px;
      cursor: pointer;
      color: var(--primary);
    }

    .search-box { display: flex; justify-content: center; margin-bottom: 15px; }
    .search-box input {
      width: 100%; max-width: 400px;
      padding: 12px 18px;
      border-radius: 25px; border: 1px solid #ccc;
      font-size: 14px; outline: none; transition: .2s;
    }
    .search-box input:focus { border-color: var(--primary); box-shadow: 0 0 6px var(--primary); }

    .letters { display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; margin-bottom: 20px; }
    .letter {
      padding: 6px 12px; border-radius: 20px; border: none; cursor: pointer;
      background: #f0f0f0; font-weight: bold; transition: .2s;
    }
    .letter:hover, .letter.active { background: var(--primary); color: white; }

    .grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(160px,1fr)); gap: 16px; }
    .item {
      background: var(--card); border-radius: 16px; padding: 16px; text-align: center;
      font-weight: 600; color: var(--text); cursor: pointer;
      box-shadow: 0 4px 10px var(--shadow); transition: all .2s ease;
    }
    .item:hover { background: var(--primary); color: white; transform: translateY(-3px); }

    .back {
      display: inline-block; margin-bottom: 20px; color: var(--primary);
      font-weight: 600; cursor: pointer; font-size: 14px; transition: color .2s;
    }
    .back:hover { color: #1e40af; }

    p {
      margin-bottom: 12px; line-height: 1.6; background: var(--card); padding: 12px;
      border-radius: 12px; box-shadow: 0 2px 6px var(--shadow);
    }

    /* menu tr√™s pontos */
    .menu {
      position: absolute;
      top: 30px;
      right: 10px;
      background: var(--card);
      box-shadow: 0 2px 8px var(--shadow);
      border-radius: 10px;
      padding: 12px;
      display: none;
      width: 250px;
      font-size: 13px;
      z-index: 10;
    }
    .menu.show { display: block; }

    /* quadradinho preto */
    .support-box {
      background: #000;
      color: #fff;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
      font-size: 12px;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
  <header>
    <h1>üìñ Novo Testamento</h1>
    <div class="top-buttons">
      <button class="icon-btn" id="themeToggle">üåô</button>
      <button class="icon-btn" id="menuToggle">‚ãÆ</button>
    </div>
    <div class="menu" id="menuBox">
      <p>üôè Agradecer ao programador pelo conhecimento B√≠blico que compartilhou comigo.</p>
      <p>üì± Mpesa: <b>856562554</b></p>
      <p>üì± eMola: <b>870338639</b></p>
      <div class="support-box">
        üíñ Se desejar apoiar, sua contribui√ß√£o ser√° sempre muito bem-vinda.<br>
        Que Deus aben√ßoe grandemente a sua vida!
      </div>
    </div>
    <div class="search-box"><input type="text" id="search" placeholder="Pesquisar livro..."></div>
    <div class="letters" id="letters"></div>
  </header>

  <div id="app"></div>

  <script>
    // =============================
    // üìå Estrutura b√°sica (livros + cap√≠tulos)
    // =============================
    const estrutura = {
      "Mateus": 28, "Marcos": 16, "Lucas": 24, "Jo√£o": 21,
      "Atos": 28, "Romanos": 16, "1 Cor√≠ntios": 16, "2 Cor√≠ntios": 13,
      "G√°latas": 6, "Ef√©sios": 6, "Filipenses": 4, "Colossenses": 4,
      "1 Tessalonicenses": 5, "2 Tessalonicenses": 3, "1 Tim√≥teo": 6,
      "2 Tim√≥teo": 4, "Tito": 3, "Filemom": 1, "Hebreus": 13, "Tiago": 5,
      "1 Pedro": 5, "2 Pedro": 3, "1 Jo√£o": 5, "2 Jo√£o": 1,
      "3 Jo√£o": 1, "Judas": 1, "Apocalipse": 22
    };

    const app = document.getElementById("app");
    let pagina = "livros";
    let livroAtual = null;
    let capAtual = null;

    // =============================
    // üìå Letras A-Z
    // =============================
    const lettersContainer = document.getElementById("letters");
    const alphabet = ["Todos",..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"];
    alphabet.forEach(l => {
      const btn = document.createElement("button");
      btn.className = "letter" + (l === "Todos" ? " active" : "");
      btn.textContent = l;
      btn.onclick = () => {
        document.querySelectorAll(".letter").forEach(el => el.classList.remove("active"));
        btn.classList.add("active");
        render(l);
      };
      lettersContainer.appendChild(btn);
    });

    // =============================
    // üìå Renderiza√ß√£o
    // =============================
    function render(filtroLetra = "Todos") {
      app.innerHTML = "";

      if (pagina === "livros") {
        const grid = document.createElement("div");
        grid.className = "grid";

        let livros = Object.keys(estrutura);
        const termo = document.getElementById("search").value.toLowerCase();
        if (termo) livros = livros.filter(l => l.toLowerCase().includes(termo));
        if (filtroLetra !== "Todos") livros = livros.filter(l => l[0].toUpperCase() === filtroLetra);

        livros.forEach(livro => {
          const a = document.createElement("div");
          a.className = "item";
          a.textContent = livro;
          a.onclick = () => { livroAtual = livro; pagina = "capitulos"; render(); };
          grid.appendChild(a);
        });

        app.appendChild(grid);

      } else if (pagina === "capitulos") {
        const back = document.createElement("div");
        back.className = "back";
        back.textContent = "‚¨Ö Voltar aos livros";
        back.onclick = () => { pagina = "livros"; render(); };
        app.appendChild(back);

        const h1 = document.createElement("h1");
        h1.textContent = "üìñ " + livroAtual;
        app.appendChild(h1);

        const grid = document.createElement("div");
        grid.className = "grid";
        for (let i = 1; i <= estrutura[livroAtual]; i++) {
          const a = document.createElement("div");
          a.className = "item";
          a.textContent = "Cap√≠tulo " + i;
          a.onclick = () => { capAtual = i; pagina = "versiculos"; render(); };
          grid.appendChild(a);
        }
        app.appendChild(grid);

      } else if (pagina === "versiculos") {
        const back = document.createElement("div");
        back.className = "back";
        back.textContent = "‚¨Ö Voltar aos cap√≠tulos";
        back.onclick = () => { pagina = "capitulos"; render(); };
        app.appendChild(back);

        const h1 = document.createElement("h1");
        h1.textContent = "üìñ " + livroAtual + " " + capAtual;
        app.appendChild(h1);

        // ‚ö° Buscar vers√≠culos online
        fetch(`https://bible-api.com/${encodeURIComponent(livroAtual)}+${capAtual}?translation=almeida`)
          .then(res => res.json())
          .then(data => {
            if (data.verses) {
              data.verses.forEach(v => {
                const p = document.createElement("p");
                p.innerHTML = `<b>${v.verse}.</b> ${v.text}`;
                app.appendChild(p);
              });
            } else { mostrarErro(); }
          })
          .catch(() => mostrarErro());
      }
    }

    function mostrarErro() {
      const p = document.createElement("p");
      p.textContent = "‚ö†Ô∏è Texto indispon√≠vel offline. Conecte-se √† internet para carregar os vers√≠culos.";
      app.appendChild(p);
    }

    document.getElementById("search").addEventListener("input", () => render());
    render();

    // =============================
    // üìå Tema Claro/Escuro
    // =============================
    const themeBtn = document.getElementById("themeToggle");
    themeBtn.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      themeBtn.textContent = document.body.classList.contains("dark") ? "‚òÄÔ∏è" : "üåô";
    });

    // =============================
    // üìå Menu Tr√™s Pontos
    // =============================
    const menuBtn = document.getElementById("menuToggle");
    const menuBox = document.getElementById("menuBox");
    menuBtn.addEventListener("click", () => {
      menuBox.classList.toggle("show");
    });

    // =============================
    // üìå Service Worker (inline)
    // =============================
    if ("serviceWorker" in navigator) {
      const swCode = `
        const CACHE_NAME = "biblia-cache-v1";
        const FILES_TO_CACHE = ["./"];
        self.addEventListener("install", e => {
          e.waitUntil(caches.open(CACHE_NAME).then(c => c.addAll(FILES_TO_CACHE)));
          self.skipWaiting();
        });
        self.addEventListener("activate", e => {
          e.waitUntil(caches.keys().then(keys => Promise.all(keys.map(k => k !== CACHE_NAME && caches.delete(k)))));
          self.clients.claim();
        });
        self.addEventListener("fetch", e => {
          e.respondWith(caches.match(e.request).then(r => r || fetch(e.request)));
        });
      `;
      const blob = new Blob([swCode], { type: "application/javascript" });
      const swUrl = URL.createObjectURL(blob);
      navigator.serviceWorker.register(swUrl);
    }
  </script>
</body>
</html>